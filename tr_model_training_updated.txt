Found 510 images belonging to 31 classes.
Found 195 images belonging to 31 classes.
Epoch 1/100
16/16 [==============================] - ETA: 0s - loss: 4.6481 - accuracy: 0.1882/usr/local/lib/python3.10/dist-packages/keras/src/engine/training.py:3103: UserWarning: You are saving your model as an HDF5 file via `model.save()`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')`.
  saving_api.save_model(
16/16 [==============================] - 57s 3s/step - loss: 4.6481 - accuracy: 0.1882 - val_loss: 2.5927 - val_accuracy: 0.4718
Epoch 2/100
16/16 [==============================] - 66s 4s/step - loss: 2.0887 - accuracy: 0.5255 - val_loss: 1.4148 - val_accuracy: 0.6000
Epoch 3/100
16/16 [==============================] - 55s 3s/step - loss: 1.0855 - accuracy: 0.7098 - val_loss: 0.6328 - val_accuracy: 0.8718
Epoch 4/100
16/16 [==============================] - 55s 3s/step - loss: 0.6523 - accuracy: 0.8137 - val_loss: 0.4072 - val_accuracy: 0.9385
Epoch 5/100
16/16 [==============================] - 75s 4s/step - loss: 0.5759 - accuracy: 0.8706 - val_loss: 0.3513 - val_accuracy: 0.9436
Epoch 6/100
16/16 [==============================] - 61s 4s/step - loss: 0.3779 - accuracy: 0.8902 - val_loss: 0.3491 - val_accuracy: 0.9436
Epoch 7/100
16/16 [==============================] - 50s 3s/step - loss: 0.3551 - accuracy: 0.9157 - val_loss: 0.2890 - val_accuracy: 0.9538
Epoch 8/100
16/16 [==============================] - 46s 3s/step - loss: 0.3172 - accuracy: 0.9196 - val_loss: 0.3284 - val_accuracy: 0.9128
Epoch 9/100
16/16 [==============================] - 58s 4s/step - loss: 0.2448 - accuracy: 0.9412 - val_loss: 0.2735 - val_accuracy: 0.9641
Epoch 10/100
16/16 [==============================] - 52s 3s/step - loss: 0.2818 - accuracy: 0.9314 - val_loss: 0.2794 - val_accuracy: 0.9590
Epoch 11/100
16/16 [==============================] - 46s 3s/step - loss: 0.2164 - accuracy: 0.9412 - val_loss: 0.2849 - val_accuracy: 0.9385
Epoch 12/100
16/16 [==============================] - 46s 3s/step - loss: 0.2775 - accuracy: 0.9255 - val_loss: 0.3676 - val_accuracy: 0.9128
Epoch 13/100
16/16 [==============================] - 57s 3s/step - loss: 0.3064 - accuracy: 0.9314 - val_loss: 0.4078 - val_accuracy: 0.8923
Epoch 14/100
16/16 [==============================] - 59s 4s/step - loss: 0.2140 - accuracy: 0.9412 - val_loss: 0.2653 - val_accuracy: 0.9538
Epoch 15/100
16/16 [==============================] - 46s 3s/step - loss: 0.1296 - accuracy: 0.9608 - val_loss: 0.2827 - val_accuracy: 0.9590
Epoch 16/100
16/16 [==============================] - 61s 4s/step - loss: 0.1236 - accuracy: 0.9745 - val_loss: 0.2574 - val_accuracy: 0.9590
Epoch 17/100
16/16 [==============================] - 56s 3s/step - loss: 0.1042 - accuracy: 0.9667 - val_loss: 0.2444 - val_accuracy: 0.9692
Epoch 18/100
16/16 [==============================] - 48s 3s/step - loss: 0.2313 - accuracy: 0.9451 - val_loss: 0.2942 - val_accuracy: 0.9333
Epoch 19/100
16/16 [==============================] - 46s 3s/step - loss: 0.1985 - accuracy: 0.9412 - val_loss: 0.3100 - val_accuracy: 0.9385
Epoch 20/100
16/16 [==============================] - 45s 3s/step - loss: 0.2806 - accuracy: 0.9255 - val_loss: 0.3309 - val_accuracy: 0.9385
Epoch 21/100
16/16 [==============================] - 59s 4s/step - loss: 0.2091 - accuracy: 0.9412 - val_loss: 0.3616 - val_accuracy: 0.9385
Epoch 22/100
16/16 [==============================] - 47s 3s/step - loss: 0.1516 - accuracy: 0.9647 - val_loss: 0.2699 - val_accuracy: 0.9538
Epoch 23/100
16/16 [==============================] - 47s 3s/step - loss: 0.1954 - accuracy: 0.9490 - val_loss: 0.3252 - val_accuracy: 0.9333
Epoch 24/100
16/16 [==============================] - 47s 3s/step - loss: 0.1259 - accuracy: 0.9627 - val_loss: 0.3264 - val_accuracy: 0.9385
Epoch 25/100
16/16 [==============================] - 46s 3s/step - loss: 0.1271 - accuracy: 0.9686 - val_loss: 0.2582 - val_accuracy: 0.9590
Epoch 26/100
16/16 [==============================] - 49s 3s/step - loss: 0.0861 - accuracy: 0.9745 - val_loss: 0.2602 - val_accuracy: 0.9538
Epoch 27/100
16/16 [==============================] - 46s 3s/step - loss: 0.0610 - accuracy: 0.9784 - val_loss: 0.2595 - val_accuracy: 0.9538
Epoch 28/100
16/16 [==============================] - 55s 3s/step - loss: 0.0813 - accuracy: 0.9824 - val_loss: 0.2245 - val_accuracy: 0.9692
Epoch 29/100
16/16 [==============================] - 46s 3s/step - loss: 0.0653 - accuracy: 0.9824 - val_loss: 0.2605 - val_accuracy: 0.9641
Epoch 30/100
16/16 [==============================] - 50s 3s/step - loss: 0.1112 - accuracy: 0.9686 - val_loss: 0.2489 - val_accuracy: 0.9692
Epoch 31/100
16/16 [==============================] - 51s 3s/step - loss: 0.0915 - accuracy: 0.9745 - val_loss: 0.2488 - val_accuracy: 0.9641
Epoch 32/100
16/16 [==============================] - 46s 3s/step - loss: 0.0710 - accuracy: 0.9784 - val_loss: 0.2834 - val_accuracy: 0.9436
Epoch 33/100
16/16 [==============================] - 46s 3s/step - loss: 0.1233 - accuracy: 0.9569 - val_loss: 0.2915 - val_accuracy: 0.9590
Epoch 34/100
16/16 [==============================] - 46s 3s/step - loss: 0.0730 - accuracy: 0.9824 - val_loss: 0.3363 - val_accuracy: 0.9538
Epoch 35/100
16/16 [==============================] - 46s 3s/step - loss: 0.0851 - accuracy: 0.9745 - val_loss: 0.2694 - val_accuracy: 0.9641
Epoch 36/100
16/16 [==============================] - 47s 3s/step - loss: 0.0815 - accuracy: 0.9804 - val_loss: 0.2753 - val_accuracy: 0.9692
Epoch 37/100
16/16 [==============================] - 49s 3s/step - loss: 0.1037 - accuracy: 0.9745 - val_loss: 0.3737 - val_accuracy: 0.9436
Epoch 38/100
16/16 [==============================] - 57s 3s/step - loss: 0.1650 - accuracy: 0.9588 - val_loss: 0.2671 - val_accuracy: 0.9692
Epoch 39/100
16/16 [==============================] - 48s 3s/step - loss: 0.1666 - accuracy: 0.9627 - val_loss: 0.2757 - val_accuracy: 0.9641
Epoch 40/100
16/16 [==============================] - 47s 3s/step - loss: 0.0757 - accuracy: 0.9765 - val_loss: 0.3023 - val_accuracy: 0.9538
Epoch 41/100
16/16 [==============================] - 50s 3s/step - loss: 0.1676 - accuracy: 0.9667 - val_loss: 0.2884 - val_accuracy: 0.9436
Epoch 42/100
16/16 [==============================] - 49s 3s/step - loss: 0.0726 - accuracy: 0.9706 - val_loss: 0.3121 - val_accuracy: 0.9436
Epoch 43/100
16/16 [==============================] - 46s 3s/step - loss: 0.1034 - accuracy: 0.9725 - val_loss: 0.2340 - val_accuracy: 0.9692
Epoch 44/100
16/16 [==============================] - 53s 3s/step - loss: 0.0526 - accuracy: 0.9863 - val_loss: 0.2560 - val_accuracy: 0.9692
Epoch 45/100
16/16 [==============================] - 47s 3s/step - loss: 0.0318 - accuracy: 0.9902 - val_loss: 0.2431 - val_accuracy: 0.9692
Epoch 46/100
16/16 [==============================] - 60s 4s/step - loss: 0.0208 - accuracy: 0.9961 - val_loss: 0.2461 - val_accuracy: 0.9641
Epoch 47/100
16/16 [==============================] - 47s 3s/step - loss: 0.0224 - accuracy: 0.9941 - val_loss: 0.2441 - val_accuracy: 0.9692
Epoch 48/100
16/16 [==============================] - 47s 3s/step - loss: 0.0153 - accuracy: 0.9980 - val_loss: 0.2348 - val_accuracy: 0.9692
Epoch 49/100
16/16 [==============================] - 47s 3s/step - loss: 0.0964 - accuracy: 0.9745 - val_loss: 0.5529 - val_accuracy: 0.8974
Epoch 50/100
16/16 [==============================] - 48s 3s/step - loss: 0.2002 - accuracy: 0.9608 - val_loss: 0.2769 - val_accuracy: 0.9436
Epoch 51/100
16/16 [==============================] - 49s 3s/step - loss: 0.1239 - accuracy: 0.9569 - val_loss: 0.3748 - val_accuracy: 0.9333
Epoch 52/100
16/16 [==============================] - 48s 3s/step - loss: 0.1094 - accuracy: 0.9686 - val_loss: 0.2562 - val_accuracy: 0.9641
Epoch 53/100
16/16 [==============================] - 49s 3s/step - loss: 0.0842 - accuracy: 0.9725 - val_loss: 0.2487 - val_accuracy: 0.9692
Epoch 54/100
16/16 [==============================] - 58s 4s/step - loss: 0.0552 - accuracy: 0.9882 - val_loss: 0.2401 - val_accuracy: 0.9692
Epoch 55/100
16/16 [==============================] - 49s 3s/step - loss: 0.0261 - accuracy: 0.9941 - val_loss: 0.2418 - val_accuracy: 0.9692
Epoch 56/100
16/16 [==============================] - 47s 3s/step - loss: 0.0196 - accuracy: 0.9941 - val_loss: 0.2394 - val_accuracy: 0.9641
Epoch 57/100
16/16 [==============================] - 50s 3s/step - loss: 0.0657 - accuracy: 0.9882 - val_loss: 0.2671 - val_accuracy: 0.9641
Epoch 58/100
16/16 [==============================] - 48s 3s/step - loss: 0.0564 - accuracy: 0.9863 - val_loss: 0.2726 - val_accuracy: 0.9590
Epoch 59/100
16/16 [==============================] - 47s 3s/step - loss: 0.0900 - accuracy: 0.9745 - val_loss: 0.2710 - val_accuracy: 0.9692
Epoch 60/100
16/16 [==============================] - 47s 3s/step - loss: 0.0529 - accuracy: 0.9765 - val_loss: 0.2940 - val_accuracy: 0.9590
Epoch 61/100
16/16 [==============================] - 50s 3s/step - loss: 0.0829 - accuracy: 0.9725 - val_loss: 0.2725 - val_accuracy: 0.9590
Epoch 62/100
16/16 [==============================] - 48s 3s/step - loss: 0.0599 - accuracy: 0.9843 - val_loss: 0.2978 - val_accuracy: 0.9538
Epoch 63/100
16/16 [==============================] - 47s 3s/step - loss: 0.1569 - accuracy: 0.9549 - val_loss: 0.4246 - val_accuracy: 0.9538
Epoch 64/100
16/16 [==============================] - 47s 3s/step - loss: 0.1113 - accuracy: 0.9686 - val_loss: 0.3860 - val_accuracy: 0.9436
Epoch 65/100
16/16 [==============================] - 49s 3s/step - loss: 0.2925 - accuracy: 0.9392 - val_loss: 0.3300 - val_accuracy: 0.9487
Epoch 66/100
16/16 [==============================] - 47s 3s/step - loss: 0.2860 - accuracy: 0.9392 - val_loss: 0.3615 - val_accuracy: 0.9436
Epoch 67/100
16/16 [==============================] - 50s 3s/step - loss: 0.1396 - accuracy: 0.9549 - val_loss: 0.3129 - val_accuracy: 0.9641
Epoch 68/100
16/16 [==============================] - 47s 3s/step - loss: 0.1561 - accuracy: 0.9549 - val_loss: 0.2874 - val_accuracy: 0.9692
Epoch 69/100
16/16 [==============================] - 47s 3s/step - loss: 0.0494 - accuracy: 0.9804 - val_loss: 0.2710 - val_accuracy: 0.9692
Epoch 70/100
16/16 [==============================] - 48s 3s/step - loss: 0.0847 - accuracy: 0.9843 - val_loss: 0.3209 - val_accuracy: 0.9538
Epoch 71/100
16/16 [==============================] - 47s 3s/step - loss: 0.0581 - accuracy: 0.9784 - val_loss: 0.3243 - val_accuracy: 0.9590
Epoch 72/100
16/16 [==============================] - 51s 3s/step - loss: 0.0515 - accuracy: 0.9882 - val_loss: 0.3043 - val_accuracy: 0.9692
Epoch 73/100
16/16 [==============================] - 50s 3s/step - loss: 0.0382 - accuracy: 0.9902 - val_loss: 0.3165 - val_accuracy: 0.9641
Epoch 74/100
16/16 [==============================] - 48s 3s/step - loss: 0.0311 - accuracy: 0.9902 - val_loss: 0.3162 - val_accuracy: 0.9692
Epoch 75/100
16/16 [==============================] - 51s 3s/step - loss: 0.0568 - accuracy: 0.9863 - val_loss: 0.3246 - val_accuracy: 0.9641
Epoch 76/100
16/16 [==============================] - 48s 3s/step - loss: 0.0646 - accuracy: 0.9824 - val_loss: 0.2949 - val_accuracy: 0.9692
Epoch 77/100
16/16 [==============================] - 49s 3s/step - loss: 0.0467 - accuracy: 0.9882 - val_loss: 0.3088 - val_accuracy: 0.9641
Epoch 78/100
16/16 [==============================] - 47s 3s/step - loss: 0.0870 - accuracy: 0.9745 - val_loss: 0.2821 - val_accuracy: 0.9692
Epoch 79/100
16/16 [==============================] - 48s 3s/step - loss: 0.0762 - accuracy: 0.9804 - val_loss: 0.2702 - val_accuracy: 0.9692
Epoch 80/100
16/16 [==============================] - 47s 3s/step - loss: 0.0763 - accuracy: 0.9765 - val_loss: 0.3760 - val_accuracy: 0.9487
Epoch 81/100
16/16 [==============================] - 48s 3s/step - loss: 0.1207 - accuracy: 0.9686 - val_loss: 0.2964 - val_accuracy: 0.9641
Epoch 82/100
16/16 [==============================] - 49s 3s/step - loss: 0.0694 - accuracy: 0.9804 - val_loss: 0.3572 - val_accuracy: 0.9436
Epoch 83/100
16/16 [==============================] - 47s 3s/step - loss: 0.1109 - accuracy: 0.9804 - val_loss: 0.2951 - val_accuracy: 0.9641
Epoch 84/100
16/16 [==============================] - 48s 3s/step - loss: 0.1812 - accuracy: 0.9549 - val_loss: 0.5775 - val_accuracy: 0.9179
Epoch 85/100
16/16 [==============================] - 49s 3s/step - loss: 0.1712 - accuracy: 0.9529 - val_loss: 0.3462 - val_accuracy: 0.9436
Epoch 86/100
16/16 [==============================] - 48s 3s/step - loss: 0.1710 - accuracy: 0.9627 - val_loss: 0.3449 - val_accuracy: 0.9590
Epoch 87/100
16/16 [==============================] - 54s 3s/step - loss: 0.0600 - accuracy: 0.9745 - val_loss: 0.3089 - val_accuracy: 0.9641
Epoch 88/100
16/16 [==============================] - 48s 3s/step - loss: 0.0231 - accuracy: 0.9902 - val_loss: 0.3510 - val_accuracy: 0.9590
Epoch 89/100
16/16 [==============================] - 50s 3s/step - loss: 0.0386 - accuracy: 0.9843 - val_loss: 0.3140 - val_accuracy: 0.9692
Epoch 90/100
16/16 [==============================] - 53s 3s/step - loss: 0.0326 - accuracy: 0.9941 - val_loss: 0.2930 - val_accuracy: 0.9692
Epoch 91/100
16/16 [==============================] - 46s 3s/step - loss: 0.0355 - accuracy: 0.9941 - val_loss: 0.3271 - val_accuracy: 0.9590
Epoch 92/100
16/16 [==============================] - 49s 3s/step - loss: 0.0576 - accuracy: 0.9804 - val_loss: 0.2813 - val_accuracy: 0.9692
Epoch 93/100
16/16 [==============================] - 54s 3s/step - loss: 0.0532 - accuracy: 0.9784 - val_loss: 0.3359 - val_accuracy: 0.9590
Epoch 94/100
16/16 [==============================] - 51s 3s/step - loss: 0.0632 - accuracy: 0.9745 - val_loss: 0.3269 - val_accuracy: 0.9538
Epoch 95/100
16/16 [==============================] - 49s 3s/step - loss: 0.0214 - accuracy: 0.9941 - val_loss: 0.3314 - val_accuracy: 0.9590
Epoch 96/100
16/16 [==============================] - 53s 3s/step - loss: 0.0340 - accuracy: 0.9863 - val_loss: 0.3357 - val_accuracy: 0.9590
Epoch 97/100
16/16 [==============================] - 52s 3s/step - loss: 0.0526 - accuracy: 0.9843 - val_loss: 0.3086 - val_accuracy: 0.9641
Epoch 98/100
16/16 [==============================] - 54s 3s/step - loss: 0.0419 - accuracy: 0.9902 - val_loss: 0.3064 - val_accuracy: 0.9641
Epoch 99/100
16/16 [==============================] - 53s 3s/step - loss: 0.0714 - accuracy: 0.9765 - val_loss: 0.3622 - val_accuracy: 0.9538
Epoch 100/100
16/16 [==============================] - 52s 3s/step - loss: 0.0414 - accuracy: 0.9863 - val_loss: 0.3790 - val_accuracy: 0.9385
Model training done! 
# Load pre-trained VGG16 model without the top layer\nbase_model = VGG16(weights=\'imagenet\', include_top=False, input_shape=(256, 256, 3))\n\n# Freeze the layers in the base VGG16 model\nfor layer in base_model.layers:\n    layer.trainable = False\n\n# Add your top layers for classification\nmodel = Sequential([\n    base_model,\n    Flatten(),\n    Dense(31, activation=\'softmax\')\n])\n\nclass_weights = compute_class_weight(class_weight=\'balanced\', classes=np.unique(train_generator.classes), y=train_generator.classes)\nclass_weights_dict = dict(enumerate(class_weights))\n\ncheckpoint = ModelCheckpoint(filepath="/content/drive/My Drive/best_tr_model/best_model.h5",  \n                             save_best_only=True,\n                             )\n\nmodel.compile(optimizer=tf.keras.optimizers.Adam(learning_rate=0.0001), loss=\'categorical_crossentropy\', metrics=[\'accuracy\'])\n\nmodel.fit(train_generator,\n          steps_per_epoch=len(train_generator),\n          epochs=10, c